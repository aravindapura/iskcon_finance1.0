# ISKCON Finance — мультивалютность

Приложение поддерживает учёт операций, долгов и целей в нескольких валютах с автоматической конвертацией в USD.

## Доступные валюты

* USD — базовая валюта
* RUB
* EUR
* GEL

## Курсы валют

* Курсы хранятся в памяти приложения и обновляются через эндпоинт `POST /api/rates/update`.
* Источник данных — сервис [exchangerate.host](https://api.exchangerate.host/latest?base=USD&symbols=RUB,EUR,GEL).
* При недоступности API используются последние сохранённые значения или fallback 1 USD = 1 единица валюты.

## Работа с данными

* При создании операций, долгов и целей нужно выбрать валюту. По умолчанию используется USD.
* Все суммы автоматически конвертируются в USD и отображаются в формате `1000 RUB (≈ $11.11)`.
* Балансы, отчёты и прогресс целей рассчитываются в USD, но дополнительно показывают агрегированные значения по исходным валютам.

## Обновление курсов

1. Перейдите на главную страницу и нажмите кнопку «Обновить курсы валют» — произойдёт вызов `POST /api/rates/update`.
2. Эндпоинт можно вызвать вручную, например с помощью `curl`:

```bash
curl -X POST https://<host>/api/rates/update
```

## Тестовые данные

* Курсы по умолчанию инициализируются значением 1, поэтому для корректных расчётов рекомендуется выполнить обновление.
* Фикстуры тестов должны добавлять записи в `db.rates` для используемых валют.
